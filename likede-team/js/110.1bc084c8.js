"use strict";(self["webpackChunklikede"]=self["webpackChunklikede"]||[]).push([[110],{5110:function(t,e,a){a.r(e),a.d(e,{default:function(){return c}});var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"main"},[e("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:t.formInline}},[e("el-form-item",{attrs:{prop:"num",label:"工单编号:"}},[e("el-input",{attrs:{clearable:"",placeholder:"请输入"},model:{value:t.formInline.num,callback:function(e){t.$set(t.formInline,"num",e)},expression:"formInline.num"}})],1),e("el-form-item",{attrs:{prop:"region",label:"工单状态:"}},[e("el-select",{attrs:{clearable:"",placeholder:"请选择  "},model:{value:t.formInline.region,callback:function(e){t.$set(t.formInline,"region",e)},expression:"formInline.region"}},t._l(t.Selectfrom,(function(t){return e("el-option",{key:t.statusId,attrs:{label:t.statusName,value:t.statusId}})})),1)],1),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("查询")])],1)],1),e("div",{staticClass:"textmain"},[e("div",{staticClass:"textmainTop"},[e("el-button",{staticClass:"mediumone",attrs:{size:"medium ",icon:"el-icon-circle-plus-outline",type:"warning"},nativeOn:{click:function(e){return t.dialogAddformFn.apply(null,arguments)}}},[t._v("新建")]),e("el-button",{staticClass:"mediumtwo",attrs:{plain:"",size:"medium ",type:"warning"},on:{click:t.attachmentFN}},[t._v("工单配置")])],1),e("el-dialog",{staticClass:"ChannelList",attrs:{title:"补货详情",visible:t.Capturedialog,width:"40%"},on:{"update:visible":function(e){t.Capturedialog=e}}},[e("el-table",{attrs:{data:t.Capturelist}},[e("el-table-column",{attrs:{property:"channelCode",label:"货道编号",width:"120"}}),e("el-table-column",{attrs:{property:"sku.brandName",label:"物品名称",width:"120"}}),e("el-table-column",{attrs:{property:"currentCapacity",label:"当前数量",width:"120"}}),e("el-table-column",{attrs:{label:"还可添加",property:"maxCapacity",width:"120"}}),e("el-table-column",{attrs:{label:"补满数量",property:"maxCapacity"}},[e("el-input-number",{attrs:{"controls-position":"right",min:0,max:10},on:{change:t.handleChange},model:{value:t.addnum,callback:function(e){t.addnum=e},expression:"addnum"}})],1)],1),e("div",{staticClass:"dialog-footer",staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.Capturedialog=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:function(e){t.Capturedialog=!1}}},[t._v("确 定")])],1)],1),e("el-dialog",{attrs:{title:"新增工单",visible:t.dialogAddform,width:"32%"},on:{"update:visible":function(e){t.dialogAddform=e},close:t.dialogAddformCancel}},[e("el-form",{ref:"Addform",staticStyle:{"padding-left":"50px"},attrs:{model:t.Addform,"label-width":"100px",rules:t.Addformrules}},[e("el-form-item",{attrs:{prop:"numb",label:"设备编号："}},[e("el-input",{staticStyle:{width:"90%"},attrs:{placeholder:"请输入",autocomplete:"off"},on:{input:t.Inputtask},model:{value:t.Addform.numb,callback:function(e){t.$set(t.Addform,"numb",e)},expression:"Addform.numb"}})],1),e("el-form-item",{attrs:{prop:"value1",label:"工单类型："}},[e("el-select",{staticStyle:{width:"90%"},attrs:{clearable:"",placeholder:"请选择"},model:{value:t.Addform.value1,callback:function(e){t.$set(t.Addform,"value1",e)},expression:"Addform.value1"}},t._l(t.selectList,(function(t){return e("el-option",{key:t.typeId,attrs:{label:t.typeName,value:t.typeId}})})),1)],1),e("el-form-item",[e("span",{staticStyle:{"margin-left":"-82px"}},[t._v(" 补货数量：")]),e("span",{staticStyle:{"margin-left":"20px",color:"#5f84ff",cursor:"pointer"},on:{click:t.CapturelistFn}},[e("i",{staticClass:"el-icon-document",staticStyle:{"font-size":"19px"}}),t._v(" 捕获清单")])]),e("el-form-item",{attrs:{prop:"value2",label:"运营人员："}},[e("el-select",{staticStyle:{width:"90%"},attrs:{clearable:"",placeholder:"请选择"},model:{value:t.Addform.value2,callback:function(e){t.$set(t.Addform,"value2",e)},expression:"Addform.value2"}},t._l(t.Inputtasklist,(function(t){return e("el-option",{key:t.userId,attrs:{label:t.userName,value:t.userId}})})),1)],1),e("el-form-item",{attrs:{prop:"remark",label:"备注："}},[e("el-input",{staticStyle:{width:"90%"},attrs:{type:"textarea",placeholder:"请输入备注(40字之内)",autocomplete:"off",maxlength:"40","show-word-limit":""},model:{value:t.Addform.remark,callback:function(e){t.$set(t.Addform,"remark",e)},expression:"Addform.remark"}})],1)],1),e("div",{staticClass:"dialog-footer",staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:t.dialogAddformCancel}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.dialogAddformTrue}},[t._v("确 定")])],1)],1),e("el-dialog",{attrs:{title:"工单配置",visible:t.dialogwarnform,width:"30%"},on:{"update:visible":function(e){t.dialogwarnform=e},close:function(e){t.dialogwarnform=!1}}},[e("el-form",{ref:"warnform",attrs:{model:t.warnform}},[e("el-form-item",{attrs:{type:"number",prop:"numb",rules:[{required:!0,message:"数据不能为空"},{type:"number",message:"数据必须为数字"}],label:"补货警戒线："}},[e("el-input",{staticStyle:{width:"80%"},attrs:{oninput:"if(value>30)value=100"},model:{value:t.warnform.numb,callback:function(e){t.$set(t.warnform,"numb",t._n(e))},expression:"warnform.numb"}})],1)],1),e("div",{staticClass:"dialog-footer",staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.dialogwarnform=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.warnformEntrue}},[t._v("确定")])],1)],1),e("el-dialog",{staticClass:"Viewdetails",attrs:{title:"工单详情",visible:t.Viewdetails,width:"30%","before-close":t.ViewdetailsFn},on:{"update:visible":function(e){t.Viewdetails=e}}},[[e("div",{staticClass:"top",staticStyle:{height:"54px"}},[e("h2",[e("i",{class:t.Viewdetailsicon}),e("span",{staticStyle:{"font-size":"14px"}},[t._v(t._s(t.Viewdetailsspan))]),e("img",{staticStyle:{float:"right","margin-top":"-30px","margin-right":"65px"},attrs:{src:t.Viewdetailsimg,alt:""}})])]),e("el-row",[e("el-col",{staticStyle:{height:"30px"},attrs:{span:12}},[e("div",{staticClass:"grid-content bg-purple"},[t._v(" 设备编号："+t._s(t.ViewdetailsList.innerCode)+" ")])]),e("el-col",{staticStyle:{height:"30px"},attrs:{span:12}},[e("div",{staticClass:"grid-content bg-purple-light"},[t._v(" 创建日期："+t._s(t.ViewdetailscreateTime)+" ")])]),e("el-col",{staticStyle:{height:"30px"},attrs:{span:12}},[e("div",{staticClass:"grid-content bg-purple"},[t._v(" 取消日期："+t._s(t.ViewdetailsupdateTime)+" ")])]),e("el-col",{staticStyle:{height:"30px"},attrs:{span:12}},[e("div",{staticClass:"grid-content bg-purple-light"},[t._v(" 运维人员："+t._s(t.ViewdetailsList.userName)+" ")])]),e("el-col",{staticStyle:{height:"30px"},attrs:{span:12}},[e("div",{staticClass:"grid-content bg-purple"},[t._v(" 工单类型："+t._s(t.ViewdetailstypeName)+" ")])]),e("el-col",{staticStyle:{height:"30px"},attrs:{span:12}},[e("div",{staticClass:"grid-content bg-purple-light"},[t._v(" 补货数量："),e("span",{staticStyle:{"margin-left":"20px",color:"#5f84ff",cursor:"pointer"},on:{click:t.CapturelistFn}},[e("i",{staticClass:"el-icon-document",staticStyle:{"font-size":"19px"}}),t._v(" 捕获清单")])])]),e("el-col",{staticStyle:{height:"30px"},attrs:{span:12}},[e("div",{staticClass:"grid-content bg-purple-light"},[t._v(" 工单方式："+t._s(t.Viewdetailstype)+" ")])]),e("el-col",{staticStyle:{height:"30px"},attrs:{span:12}},[e("div",{staticClass:"grid-content bg-purple"},[t._v("取消原因：")])])],1)],t.ViewdetailsShow?e("div",{staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[e("span",{staticClass:"dialog-footer"},[e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.Viewdetailsfrom()}}},[t._v(t._s("待办"===t.ViewdetailsName?"取消订单":"重新创办"))])],1)]):t._e()],2),e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData.currentPageRecords}},[e("el-table-column",{attrs:{prop:"pageid",label:"序号",width:"80"}}),e("el-table-column",{attrs:{prop:"taskCode",label:"工单编号",width:"200"}}),e("el-table-column",{attrs:{prop:"innerCode",label:"设备编号",width:"200"}}),e("el-table-column",{attrs:{prop:"taskType.typeName",label:"工单类型",width:"200"}}),e("el-table-column",{attrs:{prop:"createType",label:"工单方式",width:"200"}}),e("el-table-column",{attrs:{prop:"taskStatusTypeEntity.statusName",label:"工单状态",width:"200"}}),e("el-table-column",{attrs:{prop:"userName",label:"运营人员",width:"200"}}),e("el-table-column",{attrs:{prop:"createTime",label:"创建日期",width:"200"}}),e("el-table-column",{attrs:{prop:"taskId",label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function({row:a}){return[e("span",{on:{click:function(e){return t.ViewdetailsfirstFn(a.taskId)}}},[t._v("查看详情")])]}}])})],1),e("div",{staticClass:"textmainfoot",staticStyle:{"margin-top":"20px"}},[e("span",[t._v("共"+t._s(t.tableData.totalCount)+"条记录 第 "+t._s(t.tableData.pageIndex)+"/"+t._s(t.tableData.totalPage)+" 页")]),e("div",{staticClass:"textmainfoot1"},[e("el-button",{attrs:{disabled:t.Next1},on:{click:function(e){return t.pagenumFn(-1)}}},[t._v("上一页")]),e("el-button",{attrs:{disabled:t.Next2},on:{click:function(e){return t.pagenumFn(1)}}},[t._v("下一页")])],1)])],1)],1)},s=[],l=(a(7658),a(3499)),n={data(){return{formInline:{num:"",region:""},Selectfrom:[],tableData:"",pagenum:1,Next1:!0,Next2:!1,dialogwarnform:!1,dialogAddform:!1,Addform:{numb:"",value1:"",value2:"",remark:""},Addform2:{numb:"",value1:"",value2:"",remark:""},selectList:[],Addformrules:{numb:[{required:!0,message:"请输入编码",trigger:["blur","change"]}],value1:[{required:!0,message:"请选择工单类型",trigger:["blur","change"]}],value2:[{required:!0,message:"请选择运营人员",trigger:["blur","change"]}],remark:[{required:!0,message:"请输入备注",trigger:["blur","change"]}]},ArtifactList:[],Inputtasklist:[],warnform:{numb:""},Capturedialog:!1,Capturelist:[],Capturelist2:[],num:0,addnum:10,Viewdetails:!1,ViewdetailsShow:!0,ViewdetailsList:{},ViewdetailscreateTime:"",ViewdetailsupdateTime:"",ViewdetailstypeName:"",ViewdetailstypeValue:"",Viewdetailstype:0,Viewdetailsspan:"",Viewdetailsimg:"",Viewdetailsicon:"",ViewdetailsName:"",ID:""}},methods:{async TaskInfoFn(t){this.ViewdetailsList=await(0,l.w)(t),this.ViewdetailstypeName=this.ViewdetailsList.taskType.typeName,this.ViewdetailstypeValue=this.ViewdetailsList.taskType.typeId,this.ViewdetailstaskType=this.ViewdetailsList.taskType.Type,this.ViewdetailsName=this.ViewdetailsList.taskStatusTypeEntity.statusName,this.Addform2={numb:this.ViewdetailsList.innerCode,value1:this.ViewdetailstypeValue,value2:this.ViewdetailsList.assignorId,remark:this.ViewdetailsList.desc},1===this.Viewdetailstype&&(this.Viewdetailstype="手动"),0===this.Viewdetailstype&&(this.Viewdetailstype="自动"),this.ViewdetailscreateTime=this.ViewdetailsList.createTime.replace("T","ㅤ"),this.ViewdetailsupdateTime=this.ViewdetailsList.updateTime.replace("T","ㅤ"),"完成"===this.ViewdetailsList.taskStatusTypeEntity.statusName&&(this.Viewdetailsspan="完成",this.Viewdetailsicon="el-icon-success",this.Viewdetailsimg="https://likede2-admin.itheima.net/img/pic_4.3b5af41c.png",this.ViewdetailsShow=!1),"取消"===this.ViewdetailsList.taskStatusTypeEntity.statusName&&(this.Viewdetailsspan="取消",this.Viewdetailsicon="el-icon-warning",this.Viewdetailsimg="https://likede2-admin.itheima.net/img/pic_3.e8208e34.png"),"待办"===this.ViewdetailsList.taskStatusTypeEntity.statusName&&(this.Viewdetailsspan="待办",this.Viewdetailsicon="el-icon-alarm-clock",this.Viewdetailsimg="https://likede2-admin.itheima.net/img/pic_1.834b274c.png"),"进行"===this.ViewdetailsList.taskStatusTypeEntity.statusName&&(this.Viewdetailsspan="进行",this.Viewdetailsicon="el-icon-more-outline",this.Viewdetailsimg="https://likede2-admin.itheima.net/img/pic_2.3b5af41c.png")},async TaskcancelFn(t){await(0,l.rN)(t)},ViewdetailsfirstFn(t){this.TaskInfoFn(t),this.id=t,this.Viewdetails=!0},Viewdetailsfrom(){"待办"!==this.ViewdetailsName?(this.Viewdetails=!1,this.dialogAddform=!0,this.Addform=this.Addform2,this.Inputtask()):this.$confirm("取消工单后，将不能恢复，是否确认取消？","确认信息",{distinguishCancelAndClose:!0,confirmButtonText:"确定",cancelButtonText:"取消"}).then((async()=>{await this.TaskcancelFn(this.id),this.onSubmit(),this.$message({type:"success",message:"取消成功"}),this.Viewdetails=!1})).catch((t=>{this.$message({type:"info",message:"放弃保存"})}))},ViewdetailsFn(t){this.$confirm("确认关闭？").then((e=>{t(),this.ViewdetailsShow=!0})).catch((t=>{console.log(t)}))},async CapturelistFn(){""!==this.Addform.numb&&(this.Capturedialog=!0,await this.ChannelListFn(1)),""!==this.Addform2.numb&&(this.Capturedialog=!0,await this.ChannelListFn(2))},dialogAddformFn(){this.dialogAddform=!0,this.Inputtask()},dialogAddformCancel(){this.Addform={numb:"",value1:"",value2:"",remark:""},this.$refs.Addform.resetFields(),this.Inputtasklist=[],this.dialogAddform=!1},dialogAddformTrue(){this.$refs.Addform.validate((async t=>{if(!t)return this.$message.error("请填好表单"),!1;await this.AddtaskServiceFn().then((t=>{this.$message.success("添加成功"),this.onSubmit(),this.dialogAddform=!1})).catch((t=>{this.$message.error("添加失败了，"+t.response.data)}))}))},onSubmit(t){1!==t&&(this.pagenum=1),this.getworktaskFn({taskCode:this.formInline.num,isRepair:!1,status:this.formInline.region,pageIndex:this.pagenum}),console.log(1)},async getworktaskFn(t){const e=await(0,l.vv)({innerCode:this.formInline.num,...t});e.currentPageRecords.forEach(((t,a)=>{t.pageid=a+1+(e.pageIndex-1)*e.pageSize,1===t.createType&&(t.createType="手动"),0===t.createType&&(t.createType="自动"),t.createTime=t.createTime.replace("T","ㅤ")})),this.tableData=e},pagenumFn(t){this.pagenum+t!==0&&this.pagenum!==this.tableData.totalPage&&(this.pagenum+=t,1===this.pagenum?this.Next1=!0:this.Next1=!1,this.pagenum===Number(this.tableData.totalPage-1)?this.Next2=!0:this.Next2=!1,this.onSubmit(1))},async getworkstatusFn(){this.Selectfrom=await(0,l.qt)()},async supplyAlertValueFn(){this.warnform.numb=await(0,l.vm)()},async supplyConfigValueFn(t){const e=await(0,l.sI)(t);console.log(e)},warnformEntrue(){this.$refs.warnform.validate((t=>{if(!t)return this.$message.error("修改失败"),!1;this.$message.success("修改成功"),this.supplyConfigValueFn(this.warnform.numb),this.dialogwarnform=!1}))},attachmentFN(){this.dialogwarnform=!0,this.supplyAlertValueFn()},async supplySelectListFn(){const t=await(0,l.Zq)();this.selectList=t.filter((t=>2===t.type))},async AddtaskServiceFn(){await(0,l.Xy)({createType:1,innerCode:this.Addform.numb,assignorId:this.Addform.value2,productType:this.Addform.value1,desc:this.Addform.remark,details:this.Capturelist2,userId:1}),this.Capturelist2=[]},async Inputtask(){this.Inputtasklist=await(0,l.w9)(this.Addform.numb)},async ChannelListFn(t){1===t?(this.Capturelist=await(0,l.GO)(this.Addform.numb),console.log(this.Capturelist),this.Capturelist.forEach((t=>{t.sku&&this.Capturelist2.push({channelCode:t.channelCode,expectCapacity:t.maxCapacity,skuId:t.skuId,skuImage:t.sku.skuImage,skuName:t.sku.skuName})}))):this.Capturelist=await(0,l.GO)(this.Addform2.numb)},handleChange(t){console.log(t)}},created(){this.supplySelectListFn(),this.supplyAlertValueFn(),this.getworkstatusFn(),this.onSubmit()}},r=n,o=a(1001),d=(0,o.Z)(r,i,s,!1,null,"78c9cc7d",null),c=d.exports},3499:function(t,e,a){a.d(e,{GO:function(){return p},Xy:function(){return u},Zq:function(){return d},qt:function(){return l},rN:function(){return h},sI:function(){return o},vm:function(){return r},vv:function(){return n},w:function(){return m},w9:function(){return c},zC:function(){return s}});var i=a(471);const s=(t,e)=>i.Z.get(`/api/task-service/task/taskReportInfo/${t}/${e}`),l=()=>i.Z.get("/api/task-service/task/allTaskStatus"),n=({isRepair:t="",status:e="",taskCode:a="",pageIndex:s=1})=>i.Z.get("/api/task-service/task/search/",{params:{isRepair:t,status:e,pageIndex:s,taskCode:a}}),r=()=>i.Z.get("/api/task-service/task/supplyAlertValue"),o=t=>i.Z.post("/api/task-service/task/autoSupplyConfig",{alertValue:t}),d=t=>i.Z.get("/api/task-service/taskType/list",{params:{alertValue:t}}),c=t=>i.Z.get(`/api/user-service/user/operatorList/${t}`),u=t=>i.Z.post("/api/task-service/task/create",t),p=(t=0)=>i.Z.get(`/api/vm-service/channel/channelList/${t}`),m=t=>i.Z.get(`/api/task-service/task/taskInfo/${t}`),h=t=>i.Z.post(`/api/task-service/task/cancel/${t}`,{taskId:t,desc:""})}}]);
//# sourceMappingURL=110.1bc084c8.js.map