"use strict";(self["webpackChunklikede"]=self["webpackChunklikede"]||[]).push([[557],{9557:function(e,t,a){a.r(t),a.d(t,{default:function(){return _}});var i=function(){var e=this,t=e._self._c;return t("div",[t("el-row",{staticClass:"search"},[t("el-col",{attrs:{span:24}},[t("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.searchForm}},[t("el-form-item",{attrs:{label:"区域搜索："}},[t("el-input",{staticStyle:{width:"203px"},attrs:{placeholder:"请输入",size:"medium",clearable:""},model:{value:e.searchForm.name,callback:function(t){e.$set(e.searchForm,"name",t)},expression:"searchForm.name"}})],1),t("el-form-item",[t("el-button",{staticStyle:{width:"80px"},attrs:{icon:"el-icon-search",size:"medium"},on:{click:e.onSubmit}},[e._v("查询")])],1)],1)],1)],1),t("NodeDialog",{ref:"addNode",attrs:{visible:e.addVisible,totalList:e.tableData,regionForm:e.regionForm,rules:e.regionRules,type:e.type},on:{"update:visible":function(t){e.addVisible=t},beforeClose:e.beforeClose,submit:e.submit},scopedSlots:e._u(["preview"!==e.type?{key:"default",fn:function({rules:a}){return[t("el-form",{ref:"regionForm",attrs:{model:e.regionForm,rules:a}},[t("el-form-item",{attrs:{label:"区域名称：","label-width":"140px",prop:"regionName"}},[t("el-input",{attrs:{autocomplete:"off",placeholder:"请输入",maxlength:"15","show-word-limit":""},model:{value:e.regionForm.regionName,callback:function(t){e.$set(e.regionForm,"regionName",t)},expression:"regionForm.regionName"}})],1),t("el-form-item",{attrs:{label:"备注说明：","label-width":"140px",prop:"remark"}},[t("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请输入备注（不超过40字）",maxlength:"40","show-word-limit":""},model:{value:e.regionForm.remark,callback:function(t){e.$set(e.regionForm,"remark",t)},expression:"regionForm.remark"}})],1)],1)]}}:null],null,!0)},["preview"===e.type?[t("el-form",[t("el-form-item",{attrs:{label:"区域名称：","label-width":"140px"}},[t("span",[e._v(e._s(e.areaName))])]),t("el-form-item",{attrs:{label:"包含点位：","label-width":"140px",prop:"remark"}},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.previewList,"empty-text":"","cell-style":{padding:"2px 0",border:"none"},"header-cell-style":{background:"#f4f6fa"}}},[t("el-table-column",{attrs:{label:"序号",type:"index",index:1,width:"80"}}),t("el-table-column",{attrs:{label:"点位名称",width:"158"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(a.row.name))])]}}],null,!1,3650445569)}),t("el-table-column",{attrs:{label:"设备数量",width:"158"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(a.row.vmCount))])]}}],null,!1,2668385278)})],1)],1)],1)]:e._e()],2),t("el-row",{staticClass:"list"},[t("el-col",{attrs:{span:24}},[t("el-row",{staticClass:"add"},[t("el-col",[t("el-button",{attrs:{icon:"el-icon-circle-plus-outline"},on:{click:function(t){(e.type="add")&&(e.addVisible=!0)}}},[e._v("新建")])],1)],1),t("el-row",{staticClass:"table"},[t("el-col",[t("NodeTable",{attrs:{tableData:e.tableData,loading:e.loading},on:{handlePreview:e.handlePreview,handleEdit:e.handleEdit,handleDelete:e.handleDelete}})],1)],1),t("el-row",{staticClass:"page"},[t("el-col",{attrs:{span:20}},[t("span",[e._v("共"+e._s(e.totalCount)+"条记录  第 "+e._s(e.pageIndex)+"/"+e._s(e.totalPage)+" 页")])]),t("el-col",{attrs:{span:2}},[t("el-button",{class:{disable:"1"===e.pageIndex},attrs:{disabled:"1"===e.pageIndex},on:{click:function(t){return e.handlePage("dec")}}},[e._v("上一页")])],1),t("el-col",{attrs:{span:2}},[t("el-button",{class:{disable:e.pageIndex===e.totalPage},attrs:{disabled:e.pageIndex===e.totalPage},on:{click:function(t){return e.handlePage("add")}}},[e._v("下一页")])],1)],1)],1)],1)],1)},r=[],n=a(4535),l=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:e.title,visible:e.visible,width:"630px","before-close":e.beforeClose}},[e._t("default",null,{rules:e.rules}),"preview"!==e.type?t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{staticClass:"cancel",on:{click:e.beforeClose}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.$emit("submit")}}},[e._v("确认")])],1):e._e()],2)},s=[],o={props:{visible:{type:Boolean,required:!0},totalList:{type:Array,required:!0},regionForm:{type:Object,required:!0},type:{type:String,required:!0},rules:{type:Object}},data(){return{}},computed:{title(){let e=null;return"preview"===this.type?e="区域详情":"add"===this.type?e="新增区域":"edit"===this.type&&(e="修改区域"),e}},methods:{beforeClose(){this.$emit("beforeClose")}}},d=o,u=a(1001),c=(0,u.Z)(d,l,s,!1,null,"15405e4e",null),p=c.exports,m=function(){var e=this,t=e._self._c;return t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.tableData,"empty-text":"","cell-style":{padding:"2px 0",border:"none"},size:"small","header-cell-style":{background:"#f4f6fa"}}},[t("el-table-column",{attrs:{label:"序号",type:"index",index:1,width:"80"}}),t("el-table-column",{attrs:{label:"区域名称","min-width":"283"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(a.row.name))])]}}])}),t("el-table-column",{attrs:{label:"点位数","min-width":"282"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(a.row.nodeCount))])]}}])}),t("el-table-column",{attrs:{label:"备注说明","min-width":"282"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(a.row.remark))])]}}])}),t("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handlePreview(a.$index,a.row)}}},[e._v("查看详情")]),t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleEdit(a.$index,a.row)}}},[e._v("修改")]),t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleDelete(a.$index,a.row)}}},[e._v("删除")])]}}])})],1)},g=[],h={props:{tableData:{type:Array,required:!0},loading:{type:Boolean,default:!1}},methods:{handlePreview(e,t){this.$emit("handlePreview",e,t)},handleEdit(e,t){this.$emit("handleEdit",e,t)},handleDelete(e,t){this.$emit("handleDelete",e,t)}}},f=h,b=(0,u.Z)(f,m,g,!1,null,"6a9ad7ba",null),v=b.exports,w={components:{NodeDialog:p,NodeTable:v},data(){return{searchForm:{name:""},type:"",tableData:[],pageIndex:1,pageSize:10,totalCount:0,totalPage:0,addVisible:!1,loading:!1,currentRow:{},regionForm:{regionName:"",remark:""},regionRules:{regionName:[{required:!0,message:"请输入区域名称",trigger:"blur"},{validator:(e,t,a)=>{let i=!1;this.regionForm.id?(i=this.tableData.filter((e=>e.id!==this.regionForm.id)).some((e=>e.name===t)),console.log(i)):i=this.tableData.some((e=>e.name===t)),i?a(new Promise(this.$message.error("已存在此名称的区域"))):a()},trigger:"submit"}],remark:{required:!0,message:"备注不可以为空喔～",trigger:"blur"}},areaName:"",previewList:[]}},async created(){this.getList()},methods:{onSubmit(){this.getList(this.searchForm.name)},async handlePreview(e,t){this.type="preview",this.areaName=t.name;const a=await(0,n.tQ)({pageIndex:this.pageIndex,pageSize:this.pageSize,regionId:t.id});this.previewList=a.currentPageRecords,this.addVisible=!0},handleEdit(e,t){this.type="edit",this.regionForm={...t,regionName:t.name,nodeCount:""},this.addVisible=!0},async handleDelete(e,t){try{await(0,n.zO)(t.id),this.$message.success("删除成功"),this.getList()}catch(a){console.log(a),this.$notify.info({title:"提示",message:a.response.data,iconClass:"message-icon"})}},async getList(e){try{this.loading=!0;let t=[];t=e?await(0,n.xS)({pageIndex:this.pageIndex,pageSize:this.pageSize,name:e}):await(0,n.xS)({pageIndex:this.pageIndex,pageSize:this.pageSize}),this.tableData=t.currentPageRecords,this.pageIndex=t.pageIndex,this.totalCount=t.totalCount,this.totalPage=t.totalPage}finally{this.loading=!1}},handlePage(e){"dec"===e&&this.pageIndex>1&&this.pageIndex--,"add"===e&&this.pageIndex<this.totalPage&&this.pageIndex++,this.getList()},beforeClose(){this.regionForm={regionName:"",remark:""},this.addVisible=!1,"preview"!==this.type&&this.$refs.regionForm.resetFields()},async submit(){console.log(111);try{await this.$refs.regionForm.validate(),this.regionForm.id?(await(0,n.Oq)(this.regionForm),this.$message.success("修改成功！")):(await(0,n.zl)(this.regionForm),this.$message.success("新增成功！")),this.beforeClose(),this.getList()}catch(e){}}}},y=w,x=(0,u.Z)(y,i,r,!1,null,"948dcb6a",null),_=x.exports},4535:function(e,t,a){a.d(t,{H:function(){return h},IP:function(){return b},Of:function(){return f},Oq:function(){return s},Sj:function(){return v},WI:function(){return u},gz:function(){return p},iw:function(){return r},k:function(){return c},pt:function(){return w},tQ:function(){return d},tV:function(){return m},wo:function(){return g},xS:function(){return n},zO:function(){return o},zl:function(){return l}});var i=a(471);const r=()=>i.Z.get("/api/vm-service/node/nodeCollect"),n=e=>i.Z.get("/api/vm-service/region/search",{params:e}),l=e=>i.Z.post("/api/vm-service/region",e),s=e=>i.Z.put(`/api/vm-service/region/${e.id}`,e),o=e=>i.Z["delete"](`/api/vm-service/region/${e}`),d=e=>i.Z.get("/api/vm-service/node/search",{params:e}),u=()=>i.Z.get("/api/vm-service/businessType"),c=e=>i.Z.get("/api/user-service/partner/search",{params:e}),p=e=>i.Z.post("/api/vm-service/node",e),m=e=>(0,i.Z)({method:"PUT",url:`/api/vm-service/node/${e.id}`,data:e}),g=e=>i.Z["delete"](`/api/vm-service/node/${e.id}`,{params:e}),h=e=>i.Z.get(`/api/vm-service/node/vmList/${e}`),f=e=>i.Z.post("/api/user-service/partner",e),b=e=>i.Z.put(`/api/user-service/partner/${e.id}`,e),v=e=>i.Z["delete"](`/api/user-service/partner/${e.id}`,{params:e}),w=e=>i.Z.put(`/api/user-service/partner/resetPwd/${e}`)}}]);
//# sourceMappingURL=557.e9a49aaf.js.map