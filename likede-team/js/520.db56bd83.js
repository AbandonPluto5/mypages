"use strict";(self["webpackChunklikede"]=self["webpackChunklikede"]||[]).push([[520],{7520:function(t,e,i){i.r(e),i.d(e,{default:function(){return c}});var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"main"},[e("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:t.formInline}},[e("el-form-item",{attrs:{prop:"num",label:"工单编号:"}},[e("el-input",{attrs:{clearable:"",placeholder:"请输入"},model:{value:t.formInline.num,callback:function(e){t.$set(t.formInline,"num",e)},expression:"formInline.num"}})],1),e("el-form-item",{attrs:{prop:"region",label:"工单状态:"}},[e("el-select",{attrs:{clearable:"",placeholder:"请选择  "},model:{value:t.formInline.region,callback:function(e){t.$set(t.formInline,"region",e)},expression:"formInline.region"}},t._l(t.Selectfrom,(function(t){return e("el-option",{key:t.statusId,attrs:{label:t.statusName,value:t.statusId}})})),1)],1),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("查询")])],1)],1),e("div",{staticClass:"textmain"},[e("div",{staticClass:"textmainTop"},[e("el-button",{staticClass:"mediumone",attrs:{size:"medium ",icon:"el-icon-circle-plus-outline",type:"warning"},nativeOn:{click:function(e){return t.dialogAddformFn.apply(null,arguments)}}},[t._v("新建")])],1),e("el-dialog",{attrs:{title:"新增工单",visible:t.dialogAddform,width:"32%"},on:{"update:visible":function(e){t.dialogAddform=e},close:t.dialogAddformCancel}},[e("el-form",{ref:"Addform",staticStyle:{"padding-left":"50px"},attrs:{model:t.Addform,"label-width":"100px",rules:t.Addformrules}},[e("el-form-item",{attrs:{prop:"numb",label:"设备编号："}},[e("el-input",{staticStyle:{width:"90%"},attrs:{placeholder:"请输入",autocomplete:"off"},on:{input:t.Inputtask},model:{value:t.Addform.numb,callback:function(e){t.$set(t.Addform,"numb",e)},expression:"Addform.numb"}})],1),e("el-form-item",{attrs:{prop:"value1",label:"工单类型："}},[e("el-select",{staticStyle:{width:"90%"},attrs:{clearable:"",placeholder:"请选择"},model:{value:t.Addform.value1,callback:function(e){t.$set(t.Addform,"value1",e)},expression:"Addform.value1"}},t._l(t.selectList,(function(t){return e("el-option",{key:t.typeId,attrs:{label:t.typeName,value:t.typeId}})})),1)],1),e("el-form-item",{attrs:{prop:"value2",label:"运维人员："}},[e("el-select",{staticStyle:{width:"90%"},attrs:{clearable:"",placeholder:"请选择"},model:{value:t.Addform.value2,callback:function(e){t.$set(t.Addform,"value2",e)},expression:"Addform.value2"}},t._l(t.Inputtasklist,(function(t){return e("el-option",{key:t.userId,attrs:{label:t.userName,value:t.userId}})})),1)],1),e("el-form-item",{attrs:{prop:"remark",label:"备注："}},[e("el-input",{staticStyle:{width:"90%"},attrs:{type:"textarea",placeholder:"请输入备注(40字之内)",autocomplete:"off",maxlength:"40","show-word-limit":""},model:{value:t.Addform.remark,callback:function(e){t.$set(t.Addform,"remark",e)},expression:"Addform.remark"}})],1)],1),e("div",{staticClass:"dialog-footer",staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:t.dialogAddformCancel}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.dialogAddformTrue}},[t._v("确 定")])],1)],1),e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData.currentPageRecords}},[e("el-table-column",{attrs:{prop:"pageid",label:"序号",width:"80"}}),e("el-table-column",{attrs:{prop:"taskCode",label:"工单编号",width:"200"}}),e("el-table-column",{attrs:{prop:"innerCode",label:"设备编号",width:"200"}}),e("el-table-column",{attrs:{prop:"taskType.typeName",label:"工单类型",width:"200"}}),e("el-table-column",{attrs:{prop:"createType",label:"工单方式",width:"200"}}),e("el-table-column",{attrs:{prop:"taskStatusTypeEntity.statusName",label:"工单状态",width:"200"}}),e("el-table-column",{attrs:{prop:"userName",label:"运营人员",width:"200"}}),e("el-table-column",{attrs:{prop:"createTime",label:"创建日期",width:"200"}}),e("el-table-column",{attrs:{prop:"address",label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function({row:i}){return[e("span",{on:{click:function(e){return t.ViewdetailsfirstFn(i.taskId)}}},[t._v("查看详情")])]}}])})],1),e("el-dialog",{staticClass:"Viewdetails",attrs:{title:"工单详情",visible:t.Viewdetails,width:"30%"},on:{"update:visible":function(e){t.Viewdetails=e}}},[[e("div",{staticClass:"top",staticStyle:{height:"54px"}},[e("h2",[e("i",{class:t.Viewdetailsicon}),e("span",{staticStyle:{"font-size":"14px"}},[t._v(t._s(t.Viewdetailsspan))]),e("img",{staticStyle:{float:"right","margin-top":"-30px","margin-right":"65px"},attrs:{src:t.Viewdetailsimg,alt:""}})])]),e("el-row",[e("el-col",{staticStyle:{height:"30px"},attrs:{span:12}},[e("div",{staticClass:"grid-content bg-purple"},[t._v(" 设备编号："+t._s(t.ViewdetailsList.innerCode)+" ")])]),e("el-col",{staticStyle:{height:"30px"},attrs:{span:12}},[e("div",{staticClass:"grid-content bg-purple-light"},[t._v(" 创建日期："+t._s(t.ViewdetailscreateTime)+" ")])]),e("el-col",{staticStyle:{height:"30px"},attrs:{span:12}},[e("div",{staticClass:"grid-content bg-purple-light"},[t._v(" 运维人员："+t._s(t.ViewdetailsList.userName)+" ")])]),e("el-col",{staticStyle:{height:"30px"},attrs:{span:12}},[e("div",{staticClass:"grid-content bg-purple"},[t._v(" 工单类型："+t._s(t.ViewdetailstypeName)+" ")])]),e("el-col",{staticStyle:{height:"30px"},attrs:{span:12}},[e("div",{staticClass:"grid-content bg-purple-light"},[t._v(" 工单方式："+t._s(t.Viewdetailstype)+" ")])]),e("el-col",{staticStyle:{height:"30px"},attrs:{span:12}},[e("div",{staticClass:"grid-content bg-purple"},[t._v(" 备注: "+t._s(t.ViewdetailsList.desc)+" ")])]),e("el-col",{staticStyle:{height:"30px"},attrs:{span:24}},[e("div",{staticClass:"grid-content bg-purple"},[t._v(" 定位: "),e("i",{staticClass:"el-icon-map-location"}),t._v(t._s(t.ViewdetailsList.addr)+" ")])])],1)],t.ViewdetailsShow?e("div",{staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[e("span",{staticClass:"dialog-footer"},[e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.Viewdetailsfrom()}}},[t._v(t._s("待办"===t.ViewdetailsName?"取消订单":"重新创办"))])],1)]):t._e()],2),e("div",{staticClass:"textmainfoot",staticStyle:{"margin-top":"20px"}},[e("span",[t._v("共"+t._s(t.tableData.totalCount)+"条记录 第 "+t._s(t.tableData.pageIndex)+"/"+t._s(t.tableData.totalPage)+" 页")]),e("div",{staticClass:"textmainfoot1"},[e("el-button",{attrs:{disabled:t.Next1},on:{click:function(e){return t.pagenumFn(-1)}}},[t._v("上一页")]),e("el-button",{attrs:{disabled:t.Next2},on:{click:function(e){return t.pagenumFn(1)}}},[t._v("下一页")])],1)])],1)],1)},s=[],l=i(3499),r={data(){return{formInline:{num:"",region:""},Selectfrom:[],tableData:"",pagenum:1,Next1:!0,Next2:!1,dialogwarnform:!1,dialogAddform:!1,Addform:{numb:"",value1:"",value2:"",remark:""},selectList:[],Addformrules:{numb:[{required:!0,message:"请输入编码",trigger:["blur","change"]}],value1:[{required:!0,message:"请选择工单类型",trigger:["blur","change"]}],value2:[{required:!0,message:"请选择运营人员",trigger:["blur","change"]}],remark:[{required:!0,message:"请输入备注",trigger:["blur","change"]}]},ArtifactList:[],Inputtasklist:[],warnform:{numb:""},Viewdetails:!1,ViewdetailsShow:!0,ViewdetailsList:{},ViewdetailscreateTime:"",ViewdetailsupdateTime:"",ViewdetailstypeName:"",Viewdetailstype:0,Viewdetailsspan:"",Viewdetailsimg:"",Viewdetailsicon:"",ViewdetailsName:"",ID:""}},methods:{async TaskcancelFn(t){await(0,l.rN)(t)},Viewdetailsfrom(){"待办"!==this.ViewdetailsName?(this.Viewdetails=!1,this.dialogAddform=!0,this.Addform=this.Addform2,this.Inputtask()):this.$confirm("","取消工单后，将不能恢复，是否确认取消？",{distinguishCancelAndClose:!0,confirmButtonText:"确定",cancelButtonText:"取消"}).then((async()=>{const t=this.TaskcancelFn(this.id);console.log(t),await this.onSubmit(1),this.$message({type:"success",message:"取消成功"}),this.Viewdetails=!1})).catch((t=>{this.$message({message:"放弃取消"})}))},ViewdetailsfirstFn(t){this.TaskInfoFn(t),this.id=t,this.Viewdetails=!0},async TaskInfoFn(t){this.ViewdetailsList=await(0,l.w)(t),console.log(this.ViewdetailsList),this.Addform2={numb:this.ViewdetailsList.innerCode,value1:this.ViewdetailsList.productTypeId,value2:this.ViewdetailsList.userName,remark:this.ViewdetailsList.desc},this.ViewdetailstypeName=this.ViewdetailsList.taskType.typeName,this.ViewdetailstaskType=this.ViewdetailsList.taskType.Type,this.ViewdetailsName=this.ViewdetailsList.taskStatusTypeEntity.statusName,1===this.Viewdetailstype&&(this.Viewdetailstype="手动"),0===this.Viewdetailstype&&(this.Viewdetailstype="自动"),this.ViewdetailscreateTime=this.ViewdetailsList.createTime.replace("T","ㅤ"),this.ViewdetailsupdateTime=this.ViewdetailsList.updateTime.replace("T","ㅤ"),"完成"===this.ViewdetailsList.taskStatusTypeEntity.statusName&&(this.Viewdetailsspan="完成",this.Viewdetailsicon="el-icon-success",this.Viewdetailsimg="https://likede2-admin.itheima.net/img/pic_4.3b5af41c.png",this.ViewdetailsShow=!1),"取消"===this.ViewdetailsList.taskStatusTypeEntity.statusName&&(this.Viewdetailsspan="取消",this.Viewdetailsicon="el-icon-warning",this.Viewdetailsimg="https://likede2-admin.itheima.net/img/pic_3.e8208e34.png"),"待办"===this.ViewdetailsList.taskStatusTypeEntity.statusName&&(this.Viewdetailsspan="待办",this.Viewdetailsicon="el-icon-alarm-clock",this.Viewdetailsimg="https://likede2-admin.itheima.net/img/pic_1.834b274c.png"),"进行"===this.ViewdetailsList.taskStatusTypeEntity.statusName&&(this.Viewdetailsspan="进行",this.Viewdetailsicon="el-icon-more-outline",this.Viewdetailsimg="https://likede2-admin.itheima.net/img/pic_2.3b5af41c.png")},dialogAddformFn(){this.dialogAddform=!0,this.Inputtask()},dialogAddformCancel(){this.Addform={numb:"",value1:"",value2:"",remark:""},this.$refs.Addform.resetFields(),this.Inputtasklist=[],this.dialogAddform=!1},dialogAddformTrue(){this.$refs.Addform.validate((async t=>{if(!t)return this.$message.error("请填好表单"),!1;await this.AddtaskServiceFn().then((t=>{this.$message.success("添加成功"),this.getworktaskFn({taskCode:this.formInline.num,isRepair:!0,status:this.formInline.region,pageIndex:this.pagenum}),this.dialogAddformCancel()})).catch((t=>{this.$message.error("添加失败了，"+t.response.data)}))}))},onSubmit(t){1!==t&&(this.pagenum=1),this.getworktaskFn({taskCode:this.formInline.num,isRepair:!0,status:this.formInline.region,pageIndex:this.pagenum})},async getworktaskFn(t){const e=await(0,l.vv)({innerCode:this.formInline.num,...t});e.currentPageRecords.forEach(((t,i)=>{t.pageid=i+1+(e.pageIndex-1)*e.pageSize,1===t.createType&&(t.createType="手动"),0===t.createType&&(t.createType="自动"),t.createTime=t.createTime.replace("T","ㅤ")})),this.tableData=e},pagenumFn(t){this.pagenum+t===1?this.Next1=!0:this.Next1=!1,this.pagenum===Number(this.tableData.totalPage-1)?this.Next2=!0:this.Next2=!1,this.pagenum+t!==0&&this.pagenum!==this.tableData.totalPage&&(this.pagenum+=t,this.onSubmit(1))},async getworkstatusFn(){this.Selectfrom=await(0,l.qt)()},async supplySelectListFn(){const t=await(0,l.Zq)();this.selectList=t.filter((t=>1===t.type))},async AddtaskServiceFn(){await(0,l.Xy)({createType:1,innerCode:this.Addform.numb,assignorId:this.Addform.value2,productType:this.Addform.value1,desc:this.Addform.remark,details:[],userId:1})},async Inputtask(){this.Inputtasklist=await(0,l.w9)(this.Addform.numb)}},created(){this.supplySelectListFn(),this.onSubmit(),this.getworkstatusFn()}},n=r,o=i(1001),d=(0,o.Z)(n,a,s,!1,null,"e7691e22",null),c=d.exports},3499:function(t,e,i){i.d(e,{GO:function(){return p},Xy:function(){return u},Zq:function(){return d},qt:function(){return l},rN:function(){return h},sI:function(){return o},vm:function(){return n},vv:function(){return r},w:function(){return m},w9:function(){return c},zC:function(){return s}});var a=i(471);const s=(t,e)=>a.Z.get(`/api/task-service/task/taskReportInfo/${t}/${e}`),l=()=>a.Z.get("/api/task-service/task/allTaskStatus"),r=({isRepair:t="",status:e="",taskCode:i="",pageIndex:s=1})=>a.Z.get("/api/task-service/task/search/",{params:{isRepair:t,status:e,pageIndex:s,taskCode:i}}),n=()=>a.Z.get("/api/task-service/task/supplyAlertValue"),o=t=>a.Z.post("/api/task-service/task/autoSupplyConfig",{alertValue:t}),d=t=>a.Z.get("/api/task-service/taskType/list",{params:{alertValue:t}}),c=t=>a.Z.get(`/api/user-service/user/operatorList/${t}`),u=t=>a.Z.post("/api/task-service/task/create",t),p=(t=0)=>a.Z.get(`/api/vm-service/channel/channelList/${t}`),m=t=>a.Z.get(`/api/task-service/task/taskInfo/${t}`),h=t=>a.Z.post(`/api/task-service/task/cancel/${t}`,{taskId:t,desc:""})}}]);
//# sourceMappingURL=520.db56bd83.js.map