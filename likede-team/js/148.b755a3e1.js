"use strict";(self["webpackChunklikede"]=self["webpackChunklikede"]||[]).push([[148],{8148:function(e,t,s){s.r(t),s.d(t,{default:function(){return x}});var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"pople"},[t("el-card",{staticClass:"box-card"},[t("span",{staticClass:"tittle"},[e._v("人员搜索:")]),t("el-input",{staticClass:"bigbox",attrs:{placeholder:"请输入"},model:{value:e.findlist.userName,callback:function(t){e.$set(e.findlist,"userName",t)},expression:"findlist.userName"}}),t("el-button",{staticClass:"btn",attrs:{type:"primary",size:"medium"},on:{click:e.findfn}},[e._v("查询")])],1),t("el-button",{staticClass:"add",attrs:{icon:"el-icon-circle-plus-outline"},on:{click:e.showDialog}},[e._v("新建")]),t("el-dialog",{attrs:{title:this.fromlist.regionId?"编辑":"新增","custom-class":"radio",visible:e.dialogVisible,width:"45%","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-form",{ref:"fff",attrs:{"label-width":"80px",model:e.fromlist,rules:e.roleRules}},[t("el-form-item",{attrs:{label:"人员名称",prop:"userName"}},[t("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.fromlist.userName,callback:function(t){e.$set(e.fromlist,"userName",t)},expression:"fromlist.userName"}})],1),t("i",[e._v("角色 :")]),t("el-select",{ref:"sele",staticStyle:{width:"87%","margin-bottom":"15px","margin-left":"45px"},attrs:{placeholder:"请选择"},model:{value:e.fromlist.roleId,callback:function(t){e.$set(e.fromlist,"roleId",t)},expression:"fromlist.roleId"}},e._l(e.roleList,(function(e){return t("el-option",{key:e.roleId,attrs:{label:e.roleName,value:e.roleId}})})),1),t("el-form-item",{attrs:{label:"联系电话",prop:"mobile"}},[t("el-input",{attrs:{type:"text",placeholder:"请输入内容",maxlength:"11","show-word-limit":""},model:{value:e.fromlist.mobile,callback:function(t){e.$set(e.fromlist,"mobile",t)},expression:"fromlist.mobile"}})],1),t("i",[e._v("负责区域:")]),t("el-select",{staticStyle:{width:"545px","margin-bottom":"15px","margin-left":"20px"},attrs:{placeholder:"请选择"},model:{value:e.fromlist.regionId,callback:function(t){e.$set(e.fromlist,"regionId",t)},expression:"fromlist.regionId"}},e._l(e.regionList,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1),t("el-form-item",[t("i",{staticStyle:{transform:"translate(-20px, 10px)"}},[e._v("头像：")]),t("el-upload",{staticClass:"upload-demo",attrs:{drag:"",action:"https://jsonplaceholder.typicode.com/posts/",multiple:""},model:{value:e.fromlist.image,callback:function(t){e.$set(e.fromlist,"image",t)},expression:"fromlist.image"}},[t("i",{staticClass:"el-icon-upload"}),t("div",{staticClass:"el-upload__text"},[e._v(" 将文件拖到此处，或"),t("em",[e._v("点击上传")])]),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(" 支持扩展名：jpg、png，文件不得大于100kb ")])])],1),t("i",{staticStyle:{"margin-left":"19px"}},[e._v("状态")]),t("el-form-item",[t("el-checkbox",{staticStyle:{transform:"translate(-10px, -28px)"},model:{value:e.fromlist.status,callback:function(t){e.$set(e.fromlist,"status",t)},expression:"fromlist.status"}},[e._v("是否启用")])],1)],1),t("template",{slot:"footer"},[t("el-button",{staticStyle:{transform:"translate(-330px, -52px)"},on:{click:e.addfn}},[e._v("取 消")]),t("el-button",{staticStyle:{transform:"translate(-306px, -52px)"},attrs:{type:"primary"},on:{click:e.confirmAdd}},[e._v("确 定")])],1)],2),t("el-table",{staticClass:"Table",staticStyle:{width:"100%"},attrs:{data:e.list}},[t("el-table-column",{attrs:{prop:"date",label:"序号",width:"120",type:"index"}}),t("el-table-column",{attrs:{prop:"userName",label:"人员名称",width:"300"}}),t("el-table-column",{attrs:{prop:"regionName",label:"归属区域",width:"300"}}),t("el-table-column",{attrs:{prop:"role.roleName",label:"角色",width:"300"}}),t("el-table-column",{attrs:{prop:"mobile",label:"联系电话",width:"450"}}),t("el-table-column",{attrs:{prop:"zip",label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.handleEdit(s.$index,s.row)}}},[e._v("修改")]),t("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.handleDelete(s.$index,s.row)}}},[e._v("删除")])]}}])})],1),t("div",{staticClass:"block"},[t("span",[e._v("共"+e._s(e.totalCount)+"条记录 第"+e._s(e.pageIndex)+"/"+e._s(e.totalPage)+"页")]),t("el-row",{staticClass:"info"},[t("el-button",{staticClass:"bix",attrs:{type:"info"},on:{click:e.upfn}},[e._v("上一页")]),t("el-button",{attrs:{type:"info"},on:{click:e.nextfn}},[e._v("下一页")])],1)],1)],1)},l=[],a=s(471);const r=e=>(0,a.Z)({url:"/api/user-service/user/search",method:"get",params:e}),o=e=>a.Z["delete"](`/api/user-service/user/${e}`),n=e=>(0,a.Z)({url:"/api/user-service/user",method:"post",data:e}),m=e=>(0,a.Z)({url:"/api/user-service/role",method:"get",params:e}),d=e=>(0,a.Z)({url:"/api/vm-service/region/search?pageIndex=1&pageSize=100000",method:"get",params:e}),c=e=>(0,a.Z)({url:"/api/user-service/role",method:"GET",params:e}),u=(e,t)=>(0,a.Z)({url:`/api/user-service/user/${e}`,method:"PUT",data:t}),p=e=>(0,a.Z)({url:"/api/user-service/user/search",method:"GET",params:e});var f={data(){return{list:[],pageIndex:1,totalCount:"",totalPage:"",pageSize:"",dialogVisible:!1,findlist:{userName:"",pageIndex:"",pageSize:""},value:"",fromlist:{mobile:"",userName:"",regionId:"",regionName:"",status:"",image:"",roleId:"",checked:"",loginName:""},roleRules:{userName:[{required:!0,message:"活动名称不能为空",trigger:"blur"}],mobile:[{required:!0,message:"请输入您的手机号码哦",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"手机号格式不正确",trigger:"blur"}]},checked:!1,options:[{value:"选项1",label:"黄金糕"}],roleList:[],regionList:[]}},async created(){this.getUserTableData()},computed:{showtitle(){return this.fromlist.regionId?"编辑部门":"新增部门"}},methods:{async findfn(){const e=await p(this.findlist);this.list=e.currentPageRecords,console.log(e)},async handleEdit(e,t){this.dialogVisible=!0,await c(this.fromlist),console.log(t),this.fromlist.userName=t.userName,this.fromlist.mobile=t.mobile,this.fromlist.regionId=t.regionId,this.fromlist.status=t.status,this.fromlist.image=t.image,this.fromlist.regionName=t.regionName,this.fromlist.roleId=t.role.regionId,this.fromlist.checked=t.checked},async showDialog(){this.dialogVisible=!0,this.roleList=await m();const{currentPageRecords:e}=await d();this.regionList=e},async confirmAdd(){this.fromlist.regionId&&await u(this.fromlist.roleId,this.fromlist),await this.$nextTick(),this.fromlist.regionName=this.regionList.find((e=>e.id===this.fromlist.regionId)).name;const e=await n(this.fromlist);e&&(this.dialogVisible=!1,this.$message.success("新增成功"),this.$refs.fff.resetFields(),this.fromlist={mobile:"",userName:"",regionId:"",regionName:"",status:"",image:"",roleId:"",checked:"",loginName:""},this.getUserTableData())},nextfn(){console.log(this.totalPage,this.pageIndex),this.pageIndex!==this.totalPage&&(this.pageIndex=Number(this.pageIndex)+1,this.getUserTableData())},async getUserTableData(){const e={pageIndex:this.pageIndex,pageSize:10,userName:"",roleId:"",isRepair:""},{currentPageRecords:t,pageIndex:s,totalCount:i,totalPage:l,pageSize:a}=await r(e);this.list=t,this.pageIndex=s,this.totalPage=l,this.totalCount=i,this.pageSize=a},upfn(){0!==this.pageIndex&&(this.pageIndex=Number(this.pageIndex)-1,this.getUserTableData())},handleClose(e){this.$confirm("确认关闭？").then((t=>{e(),this.$refs.fff.resetFields()})).catch((e=>{}))},async handleDelete(e,t){try{await o(t.id),this.getUserTableData(),this.$message.success("删除成功！")}catch(s){this.$message.success("删除没有成功,请重新删除")}},addfn(){this.dialogVisible=!1,this.$refs.fff.resetFields(),n({userName:this.fromlist.username,roleId:this.fromlist.roleid,mobile:this.fromlist.mobile,regionId:this.fromlist.regionId,regionName:this.fromlist.regionName,status:this.fromlist.status,image:this.fromlist.imagey})}}},h=f,g=s(1001),b=(0,g.Z)(h,i,l,!1,null,null,null),x=b.exports}}]);
//# sourceMappingURL=148.b755a3e1.js.map